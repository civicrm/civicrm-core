# CiviCRM 5.9.0

Released January 2, 2019;

- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**

## <a name="features"></a>Features

### Core CiviCRM

- **crm- Missing Summary ([13219](https://github.com/civicrm/civicrm-core/pull/13219))**

## <a name="bugs"></a>Bugs resolved

### Core CiviCRM

- **dev/core#442 Fix Style issues on word replacements, credit card expir… ([13197](https://github.com/civicrm/civicrm-core/pull/13197))**

- **Api3 - Add uf_user contact search param ([13230](https://github.com/civicrm/civicrm-core/pull/13230))**

- **dev/core#407 Fix mis-saving of price field values under localisation. ([13226](https://github.com/civicrm/civicrm-core/pull/13226))**

- **dev/core#518 Fix lybunt performance ([13088](https://github.com/civicrm/civicrm-core/pull/13088))**

- **5.8 to master ([13235](https://github.com/civicrm/civicrm-core/pull/13235))**

- **Typos, simplify if statement ([13233](https://github.com/civicrm/civicrm-core/pull/13233))**

- **dev/core#563: Duplicate Case manager role fix ([13188](https://github.com/civicrm/civicrm-core/pull/13188))**

- **dev/core#529 open search panes when when reviewing smart groups if they have stuff selected ([13217](https://github.com/civicrm/civicrm-core/pull/13217))**

- **5.8 ([13229](https://github.com/civicrm/civicrm-core/pull/13229))**

- **Add custom search handling for jcalendar converstion. ([13209](https://github.com/civicrm/civicrm-core/pull/13209))**

- **[CRM-19115](https://issues.civicrm.org/jira/browse/CRM-19115) PHP and MySQL timezones mismatch over API but not in UI ([13220](https://github.com/civicrm/civicrm-core/pull/13220) and [13218](https://github.com/civicrm/civicrm-core/pull/13218))**

- **[REF] Rename recently added getUrlVariables getFormVariables function… ([13225](https://github.com/civicrm/civicrm-core/pull/13225))**

- **dev/core/482 standardize contact edit form delete block behavior ([13169](https://github.com/civicrm/civicrm-core/pull/13169))**

- **dev/core#573 Fix select2 height on public pages ([13223](https://github.com/civicrm/civicrm-core/pull/13223))**

- **Set default financial_type_id for creating new payment processors (form & api) ([13181](https://github.com/civicrm/civicrm-core/pull/13181))**

- **Make world_region translate on advanced search field ([13212](https://github.com/civicrm/civicrm-core/pull/13212))**

- **Prototype for metadata based fields on search screens. ([13013](https://github.com/civicrm/civicrm-core/pull/13013))**

- ** Add \Civi\Token\TokenProcessor::getContextValues() ([13214](https://github.com/civicrm/civicrm-core/pull/13214))**

- **Remove '$dao->free()' part 1 ([13192](https://github.com/civicrm/civicrm-core/pull/13192))**

- **dev/core#11: Email - send now error screen should display earlier ([13207](https://github.com/civicrm/civicrm-core/pull/13207))**

- **[REF] refactor shared search functions in pre-Process ([13210](https://github.com/civicrm/civicrm-core/pull/13210))**

- **dev/core#561 Convert Pledge Payment form to use datepicker rather tha… ([13206](https://github.com/civicrm/civicrm-core/pull/13206))**

- **dev/core#561 Convert DateAdded and Tagged Contributions custom search… ([13208](https://github.com/civicrm/civicrm-core/pull/13208))**

- **dev/core#561 Convert Activity Custom Search from jcalendar to datepic… ([13203](https://github.com/civicrm/civicrm-core/pull/13203))**

- **dev/core#561 Replace jacalendar with datepicker in Price Field Form ([13196](https://github.com/civicrm/civicrm-core/pull/13196))**

- **dev/mail#23: Bounce processing doesn't catch pattern 'user doesn't exist' ([13200](https://github.com/civicrm/civicrm-core/pull/13200))**

- **Prevent viewport jump when toggling help on "Administer CiviCRM" screen ([13173](https://github.com/civicrm/civicrm-core/pull/13173))**

- **dev-core#565: Make subject field of Note, inline editable in contact summary page ([13190](https://github.com/civicrm/civicrm-core/pull/13190))**

- **dev/core#498 Update Mailing Report to fix undefined property error ([13194](https://github.com/civicrm/civicrm-core/pull/13194))**

- **Remove Defunct Templates from CiviMail ([13201](https://github.com/civicrm/civicrm-core/pull/13201))**

- **(NFC) Regenerate DAO Checksums after changes to codegen ([13204](https://github.com/civicrm/civicrm-core/pull/13204))**

- **dev/core#561 Remove jcalendar from the Event Aggregate Custom Search ([13198](https://github.com/civicrm/civicrm-core/pull/13198))**

- **Update npm dependencies to fix audit issues ([13195](https://github.com/civicrm/civicrm-core/pull/13195))**

- **Flatten fix ([13176](https://github.com/civicrm/civicrm-core/pull/13176))**

- **dev/core#125 Fix Doc url to custom fields user documentation ([13199](https://github.com/civicrm/civicrm-core/pull/13199))**

- **(REF) Allow subclasses of AbstractTokenSubscriber to override the determination of active tokens. ([13186](https://github.com/civicrm/civicrm-core/pull/13186))**

- **5.8 ([13193](https://github.com/civicrm/civicrm-core/pull/13193))**

- **Extract getContributionBalance function, use that rather than wrapper… ([13151](https://github.com/civicrm/civicrm-core/pull/13151))**

- **Test support for fixing dev/core#397 including adding Rule api ([13179](https://github.com/civicrm/civicrm-core/pull/13179))**

- **5.8 ([13184](https://github.com/civicrm/civicrm-core/pull/13184))**

- **5.8 ([13182](https://github.com/civicrm/civicrm-core/pull/13182))**

- **(dev/core#559) Declare crmUi's dependency on ui.utils. ([13180](https://github.com/civicrm/civicrm-core/pull/13180))**

- **Displayvalue fixes ([13175](https://github.com/civicrm/civicrm-core/pull/13175))**

- **dev/core#505 Allow Extensions to specify crmType and phpType when dea… ([13059](https://github.com/civicrm/civicrm-core/pull/13059))**

- **Fixes to enable UserDashboard tests to all run ([13147](https://github.com/civicrm/civicrm-core/pull/13147))**

- **(dev/core#217) Search.setting.php - Fix mismatched metadata ([13168](https://github.com/civicrm/civicrm-core/pull/13168))**

- **Set currency template variable from contribution pages ([13157](https://github.com/civicrm/civicrm-core/pull/13157))**

- **Api3 profile:submit - fix handling of greeting fields ([13161](https://github.com/civicrm/civicrm-core/pull/13161))**

- **Avoid permission checking on getOrganizationNames ([13162](https://github.com/civicrm/civicrm-core/pull/13162))**

- **Trivial code cleanup ([13166](https://github.com/civicrm/civicrm-core/pull/13166))**

- **[NFC] Extract getUserCheckSum function ([13167](https://github.com/civicrm/civicrm-core/pull/13167))**

- **(dev/core#217) PrevNext - Implement Redis. Decouple Query::getCachedContacts(). ([12665](https://github.com/civicrm/civicrm-core/pull/12665))**

- **dev/core#371 remove please print this page text ([13156](https://github.com/civicrm/civicrm-core/pull/13156))**

- **5.8 to master ([13154](https://github.com/civicrm/civicrm-core/pull/13154))**

- **5.8 to master ([13152](https://github.com/civicrm/civicrm-core/pull/13152))**

- **dev/core#406 fix warnings under php 7.2 when importing ([13133](https://github.com/civicrm/civicrm-core/pull/13133))**

- **dev/core#536 Remove duplicate call to contribution summary ([13149](https://github.com/civicrm/civicrm-core/pull/13149))**

- **Fix test name because it is not running & doesn't pass :-( ([13143](https://github.com/civicrm/civicrm-core/pull/13143))**

- **Fix continue / break PHP 7.3 warnings ([13066](https://github.com/civicrm/civicrm-core/pull/13066))**

- **Unit test set up tweak - Set trxn_id & invoice_id in tests as needed rather than by default. ([13146](https://github.com/civicrm/civicrm-core/pull/13146))**

- **dev/core#540 - Civicrm Contact Dashboard returns fatal error ([13140](https://github.com/civicrm/civicrm-core/pull/13140))**

- **Export code cleanup - only construct one metadata array with all types of metadata ([13126](https://github.com/civicrm/civicrm-core/pull/13126))**

- **5.8 to master ([13145](https://github.com/civicrm/civicrm-core/pull/13145))**

- **5.8 ([13135](https://github.com/civicrm/civicrm-core/pull/13135))**

- **Fix php 7.2 notice ([13132](https://github.com/civicrm/civicrm-core/pull/13132))**

- **Fix Export when full group by mode is used ([13124](https://github.com/civicrm/civicrm-core/pull/13124))**

- **Lybunt report - improve developer support for debugging this report ([13087](https://github.com/civicrm/civicrm-core/pull/13087))**

- **5.8 to master ([13130](https://github.com/civicrm/civicrm-core/pull/13130))**

- **Export code cleanup - remove silly function ([13122](https://github.com/civicrm/civicrm-core/pull/13122))**

- **dev/core#532 Batch search fix ([13121](https://github.com/civicrm/civicrm-core/pull/13121))**

- **Export code clean up - extract build row & getTransformed row off to ExportProcessor ([13117](https://github.com/civicrm/civicrm-core/pull/13117))**

- **Export class cleanup - remove some unnecessary code ([13120](https://github.com/civicrm/civicrm-core/pull/13120))**

- **dev/core#153: Pending Pay Later /w Custom payment method ([13098](https://github.com/civicrm/civicrm-core/pull/13098))**

- **Minor Contact BAO code cleanup ([13115](https://github.com/civicrm/civicrm-core/pull/13115))**

- **Update name of icon from pencil to wrench in EventInfo help ([13119](https://github.com/civicrm/civicrm-core/pull/13119))**

- **Fix Configure Event help grammar ([13118](https://github.com/civicrm/civicrm-core/pull/13118))**

- **dev/core#321: Prevent duplicate entries in civicrm_entity_file ([12650](https://github.com/civicrm/civicrm-core/pull/12650))**

- **Regression: Fix delete event participant fatal error and display name if no email ([13113](https://github.com/civicrm/civicrm-core/pull/13113))**

- **dev/core#527 Permit translation of Public Title field for Profiles ([13110](https://github.com/civicrm/civicrm-core/pull/13110))**

- **Export code cleanup - Use getComponentPaymentFields from processorClass ([13082](https://github.com/civicrm/civicrm-core/pull/13082))**

- **Fix php7.2 notices on trying to count null ([13111](https://github.com/civicrm/civicrm-core/pull/13111))**

- **dev/core#528 - Advanced Search -> Contribution Tab and Contribution D… ([13112](https://github.com/civicrm/civicrm-core/pull/13112))**

- **fix for issue-525: Extraneous br-tags in rendered note-fields ([13101](https://github.com/civicrm/civicrm-core/pull/13101))**

- **Fix warning error on php 7.2 ([13107](https://github.com/civicrm/civicrm-core/pull/13107))**

- **5.8 ([13109](https://github.com/civicrm/civicrm-core/pull/13109))**

- **5.8 ([13106](https://github.com/civicrm/civicrm-core/pull/13106))**

- **[CRM-21427](https://issues.civicrm.org/jira/browse/CRM-21427) Websites are removed from the contact if their type is empty ([13097](https://github.com/civicrm/civicrm-core/pull/13097))**

- **dev/cloud-native/issues#18: Soften messages for read-only extensionsDir ([13100](https://github.com/civicrm/civicrm-core/pull/13100))**

- **Use tab title in feedback message ([13102](https://github.com/civicrm/civicrm-core/pull/13102))**

- **Add format type to Case Start and End Dates ([13095](https://github.com/civicrm/civicrm-core/pull/13095))**

- **dev/core#193: Ensure that tax amount is calculated when checking for order API line item ([13091](https://github.com/civicrm/civicrm-core/pull/13091))**

- **5.8 to master ([13094](https://github.com/civicrm/civicrm-core/pull/13094))**

- **Activity tab code refactor ([12557](https://github.com/civicrm/civicrm-core/pull/12557))**

- **Add merge link to duplicate contact popup ([13081](https://github.com/civicrm/civicrm-core/pull/13081))**

- **Fix Job Log entries containing links so they will display properly ([12659](https://github.com/civicrm/civicrm-core/pull/12659))**

- **Fix accidental scroll when saving/deleting CiviMail draft ([13085](https://github.com/civicrm/civicrm-core/pull/13085))**

- **Trigger post hook on Event Copy ([12990](https://github.com/civicrm/civicrm-core/pull/12990))**

- **dev/core#503 - More accurate custom field checking before htmlEncode ([13076](https://github.com/civicrm/civicrm-core/pull/13076))**

- **Export code cleanup -remove meaningless code ([13083](https://github.com/civicrm/civicrm-core/pull/13083))**

- **dev/core#372 Remove notice on activity update due to trying to proces… ([13079](https://github.com/civicrm/civicrm-core/pull/13079))**

- **dev/core#513: Using payment_instrument_id instead of payment_type to determine the payment instrument when using the Transact API ([13073](https://github.com/civicrm/civicrm-core/pull/13073))**

- **5.8 ([13080](https://github.com/civicrm/civicrm-core/pull/13080))**

- **(NFC) Add in unit test of dev/core#93 expansion to allow order by of more t… ([13077](https://github.com/civicrm/civicrm-core/pull/13077))**

- **dev/core#511 Fix wrong current month showing on Membership Dashboard ([13072](https://github.com/civicrm/civicrm-core/pull/13072))**

- **5.8 to master ([13071](https://github.com/civicrm/civicrm-core/pull/13071))**

- **Merge 5.7 to master ([13069](https://github.com/civicrm/civicrm-core/pull/13069))**

- **CRM_Core_I18n::setLocale should change $tsLocale for getLocale() to work correctly ([13050](https://github.com/civicrm/civicrm-core/pull/13050))**

- **Display message template title on deletion form ([13058](https://github.com/civicrm/civicrm-core/pull/13058))**

- **Fix metadata on cancel_reason so it is an exportable field ([12775](https://github.com/civicrm/civicrm-core/pull/12775))**

- **5.7.0 release notes ([12944](https://github.com/civicrm/civicrm-core/pull/12944))**

- **dev/drupal#31 - CiviMember Role sync is no longer syncing Pending mem… ([543](https://github.com/civicrm/civicrm-drupal/pull/543))**

- **Upgrade to Quickform 3.2.16  ([224](https://github.com/civicrm/civicrm-packages/pull/224))**

- **Fix continue / break warning under PHP 7.3 ([228](https://github.com/civicrm/civicrm-packages/pull/228))**

- **5.8 to master ([231](https://github.com/civicrm/civicrm-packages/pull/231))**

- **Fix PHP7.2 warning when re-generating schema files ([232](https://github.com/civicrm/civicrm-packages/pull/232))**

- **Php 7.2 fix notice on countable ([229](https://github.com/civicrm/civicrm-packages/pull/229))**

### CiviMail

- **[CRM-19751](https://issues.civicrm.org/jira/browse/CRM-19751) Once "multiple bulk" setting, cannot search for opt out or on hold contacts ([12942](https://github.com/civicrm/civicrm-core/pull/12942))**

## <a name="misc"></a>Miscellany

## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt, Eli Lisseck; Agileware - Agileware Team, Francis Whittle; Australian Greens - Seamus Lee; Christian Wach; CiviCRM - Coleman Watts, Tim Otten; CompuCorp - Omar Abu Hussein; Coop SymbioTIC - Guillaume Boudrias, Mathieu Lutfy; Francesc Bassas i Bullich; Fuzion - Jitendra Purohit; Ginkgo Street Labs - Frank Gómez; JMA Consulting - Joe Murray, Monish Deb; John Kingsnorth; Joinery - Allen Shaw; Ken West; Lemniscus - Noah Miller; MJW Consulting - Matthew Wire; Pradeep Nayak; ray-wright; Squiffle Consulting - Aidan Saunders; thomst; tiotsop01; Wikimedia Foundation - Eileen McNaughton, Elliott Eggleston

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

AGH Strategies - Alice Frumin, Andrew Hunt, Eli Lisseck; Australian Greens - Seamus Lee; Brooks Digital - Spencer Brooks; chandana; Christian Wach; civibot[bot]; CiviCRM - Coleman Watts, Tim Otten; CompuCorp - Alessandro Verdura, Omar Abu Hussein; Coop SymbioTIC - Guillaume Boudrias; dyguk; Francesc Bassas i Bullich; Fuzion - Jitendra Purohit, Luke Stewart; iXiam - Luciano Spiegel; JMA Consulting - Monish Deb; Joinery - Allen Shaw; Korlon - Stuart Gaston; Lighthouse Design and Consulting - Brian Shaughnessy; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; pbarmak; Pradeep Nayak; ray-wright; Squiffle Consulting - Aidan Saunders; Tadpole Collective - Kevin Cristiano; Wikimedia Foundation - Eileen McNaughton