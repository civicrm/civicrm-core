<div af-api4-ctrl="tokens" af-api4="['OAuthSysToken', 'get', {'where': [['client_id', '=', options.clientId]]}]">
</div>
<div ng-if="tokens.result.length == 0">
  No tokens found
</div>

<table class="table" ng-if="tokens.result.length > 0">
  <tr>
    <th>ID</th>
    <th>Tag</th>
    <th>On Behalf Of</th>
    <th>Scopes</th>
    <th>Created Date</th>
    <th>Actions</th>
  </tr>
  <tr ng-repeat="token in tokens.result">
    <td>{{token.id}}</td>
    <td>{{token.tag}}</td>
    <td>{{token.resource_owner_name}}</td>
    <td>{{token.scopes.join(" ")}}</td>
    <td>{{token.created_date}}</td>
    <td>
      <div class="btn-group">
        <a class="btn btn-default"
           ng-if="token.access_token"
           ng-href="{{crmUrl('civicrm/admin/oauth-jwt-debug')}}#?id={{token.id|encodeURIComponent}}"
           target="_blank"
        >Inspect</a>

        <a class="btn btn-danger"
           af-api4-action="['OAuthSysToken', 'delete', {where: [['id', '=', token.id]]}]"
           af-api4-start-msg="'Deleting...'"
           af-api4-success-msg="'Deleted'"
           af-api4-success="tokens.refresh()"
        >Delete</a>
      </div>
    </td>
  </tr>
</table>
